# FastAPI и веб-фреймворк
fastapi==0.120.1  # Updated from 0.115.5 for starlette 0.49+ support (security fixes)
uvicorn[standard]==0.24.0
gunicorn==22.0.0
python-multipart==0.0.18
python-jose[cryptography]==3.4.0
passlib[bcrypt]==1.7.4
# starlette>=0.40.0,<0.51.0 managed by fastapi 0.120.1

# База данных
sqlalchemy==2.0.23
alembic==1.12.1
asyncpg==0.30.0

# Redis и кэширование
redis==5.0.1
celery==5.3.4
kombu==5.3.4
psutil==5.9.6

# NLP и обработка текста
beautifulsoup4==4.12.2
spacy==3.7.2
nltk==3.9  # Updated from 3.8.1 (CVE fix)
stanza==1.7.0
natasha==1.6.0
pymorphy3==1.2.1
gliner>=0.2.0  # NEW: GLiNER for zero-shot NER (DeepPavlov replacement)
               # F1 Score: 0.90-0.95, no dependency conflicts
               # Models: urchade/gliner_medium-v2.1 (recommended)
# deeppavlov==1.4.0  # BLOCKED: Requires fastapi<=0.89.1, pydantic<2 (we have 0.120.1, 2.5.0)
                      # REPLACED with GLiNER (F1 0.90-0.95 vs DP 0.94-0.97)
langextract==0.1.0
google-genai>=1.0.0  # NEW: Google Imagen 4 image generation API

# Парсинг книг
ebooklib==0.19
lxml==5.1.0

# HTTP клиенты и запросы
httpx[socks]==0.25.2  # SOCKS5 proxy support for LangExtract via VLESS
requests==2.32.4
aiofiles==23.2.0
aiohttp==3.12.14  # Updated from 3.9.1 (CVE-2024-52304, CVE-2024-42367, CVE-2024-30251, CVE-2024-27306, CVE-2024-23334, CVE-2024-23829, CVE-2023-49082)
                  # WARNING: Cookie storage format changed in 3.12 - may need migration script for existing cookies

# Валидация и настройки
pydantic[email]==2.5.0
pydantic-settings==2.0.3

# Логирование и мониторинг
loguru==0.7.2
sentry-sdk[fastapi]==2.8.0  # Updated from 1.38.0 (CVE fixes, major version upgrade)
                            # BREAKING CHANGES: Hub API deprecated - use isolation_scope() instead
                            # Migration: https://docs.sentry.io/platforms/python/migration/1.x-to-2.x
prometheus-client==0.19.0
prometheus-fastapi-instrumentator==6.1.0

# Безопасность
python-decouple==3.8
cryptography==44.0.1  # Updated from 43.0.1 (fixes GHSA-79v4-65xg-pq4g)
ecdsa>=0.19.0  # SECURITY NOTE: CVE-2024-23342 - No fix available yet. Accepted risk.
               # Mitigation: Ensure usage is limited to non-critical signing operations

# Тестирование
pytest==7.4.3
pytest-asyncio==0.21.1
pytest-cov==4.1.0
aiosqlite==0.19.0

# Форматирование и линтинг
black==24.3.0  # Updated from 23.11.0 (CVE-2024-21503)
ruff==0.1.6
mypy==1.7.1

# Type stubs для mypy
types-redis==4.6.0.10
types-requests==2.32.0.20241016
types-aiofiles==23.2.0.0
sqlalchemy[mypy]==2.0.23

# Утилиты
python-dateutil==2.8.2
pillow>=10.3.0
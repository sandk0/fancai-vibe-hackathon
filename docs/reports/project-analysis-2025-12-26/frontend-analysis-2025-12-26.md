# –ê–Ω–∞–ª–∏–∑ Frontend —á–∞—Å—Ç–∏ BookReader AI

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 2025-12-26
**–í–µ—Ä—Å–∏—è –ø—Ä–æ–µ–∫—Ç–∞:** –ü–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ December 2025
**–ê–Ω–∞–ª–∏—Ç–∏–∫:** Claude Code (Frontend Developer Agent)

---

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞](#1-–æ–±—â–∞—è-–æ—Ü–µ–Ω–∫–∞)
2. [–ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é](#2-–ø—Ä–æ–±–ª–µ–º—ã-—Å-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é)
3. [–ù–∞—Ä—É—à–µ–Ω–∏—è React Best Practices](#3-–Ω–∞—Ä—É—à–µ–Ω–∏—è-react-best-practices)
4. [–ü—Ä–æ–±–ª–µ–º—ã —Å TypeScript —Ç–∏–ø–∞–º–∏](#4-–ø—Ä–æ–±–ª–µ–º—ã-—Å-typescript-—Ç–∏–ø–∞–º–∏)
5. [–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞](#5-–¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ-–∫–æ–¥–∞)
6. [–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ö—É–∫–æ–≤](#6-–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ-—Ö—É–∫–æ–≤)
7. [–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ Memory Leaks](#7-–ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ-memory-leaks)
8. [–ü—Ä–æ–±–ª–µ–º—ã —Å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å—é (a11y)](#8-–ø—Ä–æ–±–ª–µ–º—ã-—Å-–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å—é-a11y)
9. [–ú–µ—Ä—Ç–≤—ã–π –∫–æ–¥](#9-–º–µ—Ä—Ç–≤—ã–π-–∫–æ–¥)
10. [–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é](#10-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏-–ø–æ-—É–ª—É—á—à–µ–Ω–∏—é)

---

## 1. –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞

### –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã

- **–ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: –•—É–∫–∏ –≥—Ä–∞–º–æ—Ç–Ω–æ —Ä–∞–∑–¥–µ–ª–µ–Ω—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º (`/hooks/api/`, `/hooks/epub/`, `/hooks/reader/`)
- **–•–æ—Ä–æ—à–µ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: IndexedDB (chapterCache, imageCache) + TanStack Query —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ staleTime
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≤ –∫–æ–¥–µ**: –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Ñ—É–Ω–∫—Ü–∏–π –∏–º–µ—é—Ç JSDoc –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
- **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ AbortController**: –í useChapterManagement –∏ useEpubLoader –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–º–µ–Ω—è—é—Ç—Å—è –∑–∞–ø—Ä–æ—Å—ã
- **–ò–∑–æ–ª—è—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ userId**: –ö—ç—à–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–∞–∑–¥–µ–ª—è—é—Ç –¥–∞–Ω–Ω—ã–µ –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

### –ü—Ä–æ–±–ª–µ–º–Ω—ã–µ –æ–±–ª–∞—Å—Ç–∏

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–±–ª–µ–º |
|-----------|-------------|-------------------|
| –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | –°—Ä–µ–¥–Ω—è—è | 8 |
| React Best Practices | –°—Ä–µ–¥–Ω—è—è | 6 |
| TypeScript | –ù–∏–∑–∫–∞—è | 4 |
| –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ | –°—Ä–µ–¥–Ω—è—è | 5 |
| –•—É–∫–∏ | –í—ã—Å–æ–∫–∞—è | 3 |
| Memory Leaks | –°—Ä–µ–¥–Ω—è—è | 4 |
| –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å (a11y) | –°—Ä–µ–¥–Ω—è—è | 7 |
| –ú–µ—Ä—Ç–≤—ã–π –∫–æ–¥ | –ù–∏–∑–∫–∞—è | 6 |

---

## 2. –ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é

### 2.1 –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –º–µ–º–æ–∏–∑–∞—Ü–∏–∏ –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö

**–§–∞–π–ª:** `/frontend/src/components/Library/BookCard.tsx`

```tsx
// –ü—Ä–æ–±–ª–µ–º–∞: –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–µ –º–µ–º–æ–∏–∑–∏—Ä–æ–≤–∞–Ω, –±—É–¥–µ—Ç —Ä–µ-—Ä–µ–Ω–¥–µ—Ä–∏—Ç—å—Å—è –ø—Ä–∏ –ª—é–±–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–æ–¥–∏—Ç–µ–ª—è
export const BookCard: React.FC<BookCardProps> = ({
  book,
  viewMode,
  onClick,
  onParsingComplete,
}) => {
```

**–†–µ—à–µ–Ω–∏–µ:**
```tsx
export const BookCard = React.memo<BookCardProps>(({
  book,
  viewMode,
  onClick,
  onParsingComplete,
}) => {
  // ...
});
```

### 2.2 –§—É–Ω–∫—Ü–∏–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –Ω–∞ –∫–∞–∂–¥—ã–π —Ä–µ–Ω–¥–µ—Ä

**–§–∞–π–ª:** `/frontend/src/components/Reader/EpubReader.tsx` (—Å—Ç—Ä–æ–∫–∏ 437-448)

```tsx
// –ü—Ä–æ–±–ª–µ–º–∞: –§—É–Ω–∫—Ü–∏—è getBackgroundColor —Å–æ–∑–¥–∞–µ—Ç—Å—è –∑–∞–Ω–æ–≤–æ –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ä–µ–Ω–¥–µ—Ä–µ
const getBackgroundColor = () => {
  switch (theme) {
    case 'light':
      return 'bg-white';
    // ...
  }
};
```

**–†–µ—à–µ–Ω–∏–µ:**
```tsx
const getBackgroundColor = useMemo(() => {
  switch (theme) {
    case 'light': return 'bg-white';
    case 'sepia': return 'bg-amber-50';
    case 'dark':
    default: return 'bg-gray-900';
  }
}, [theme]);
```

### 2.3 –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ useEffect –±–µ–∑ –º–µ–º–æ–∏–∑–∞—Ü–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

**–§–∞–π–ª:** `/frontend/src/hooks/epub/useChapterManagement.ts` (—Å—Ç—Ä–æ–∫–∞ 336)

```tsx
// –ü—Ä–æ–±–ª–µ–º–∞: loadChapterData –∑–∞–≤–∏—Å–∏—Ç –æ—Ç userId –∏ bookId –Ω–∞–ø—Ä—è–º—É—é,
// –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å—Å—è –ª–∏—à–Ω–∏–π —Ä–∞–∑ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –¥—Ä—É–≥–∏—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π
}, [userId, bookId]);
```

### 2.4 –¢—è–∂–µ–ª—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –≤ useDescriptionHighlighting

**–§–∞–π–ª:** `/frontend/src/hooks/epub/useDescriptionHighlighting.ts` (—Å—Ç—Ä–æ–∫–∏ 330-661)

```tsx
// –ü—Ä–æ–±–ª–µ–º–∞: highlightDescriptions - –æ—á–µ–Ω—å —Ç—è–∂–µ–ª–∞—è —Ñ—É–Ω–∫—Ü–∏—è,
// —Å–æ–∑–¥–∞–µ—Ç—Å—è –∑–∞–Ω–æ–≤–æ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
const highlightDescriptions = useCallback(() => {
  // 330+ —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞
}, [rendition, descriptions, imagesByDescId, onDescriptionClick, enabled, images.length]);
```

**–†–µ—à–µ–Ω–∏–µ:** –†–∞–∑–±–∏—Ç—å –Ω–∞ –±–æ–ª–µ–µ –º–µ–ª–∫–∏–µ –º–µ–º–æ–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å requestIdleCallback –¥–ª—è —Ç—è–∂–µ–ª—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π.

### 2.5 Polling –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥ –≤ LibraryPage

**–§–∞–π–ª:** `/frontend/src/pages/LibraryPage.tsx` (—Å—Ç—Ä–æ–∫–∏ 67-76)

```tsx
refetchInterval: (query) => {
  const books = query.state.data?.books || [];
  const hasProcessing = books.some(b => b.is_processing);
  if (hasProcessing) {
    console.log('üìä [LIBRARY] Found processing books, polling enabled');
    return 5000; // –ö–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥!
  }
  return false;
},
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º–æ–π –∫–Ω–∏–≥–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç polling –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥, —á—Ç–æ —Å–æ–∑–¥–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ —Å–µ—Ç—å –∏ –±–∞—Ç–∞—Ä–µ—é –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤.

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å WebSocket –∏–ª–∏ Server-Sent Events –¥–ª—è push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏.

### 2.6 –õ–∏—à–Ω–∏–µ console.log –≤ production

**–ú–Ω–æ–∂–µ—Å—Ç–≤–æ —Ñ–∞–π–ª–æ–≤ —Å–æ–¥–µ—Ä–∂–∞—Ç debug-–ª–æ–≥–∏:**

- `useDescriptionHighlighting.ts`: 50+ console.log –≤—ã–∑–æ–≤–æ–≤
- `useChapterManagement.ts`: 40+ console.log –≤—ã–∑–æ–≤–æ–≤
- `EpubReader.tsx`: 20+ console.log –≤—ã–∑–æ–≤–æ–≤

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —É—Å–ª–æ–≤–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:
```tsx
const isDev = import.meta.env.DEV;
if (isDev) console.log('...');
```

### 2.7 searchPatternsCache –∫–∞–∫ –≥–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è

**–§–∞–π–ª:** `/frontend/src/hooks/epub/useDescriptionHighlighting.ts` (—Å—Ç—Ä–æ–∫–∞ 86)

```tsx
const searchPatternsCache = new Map<string, SearchPatterns>();
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö—ç—à –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –æ—á–∏—â–∞–µ—Ç—Å—è, —á—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —É—Ç–µ—á–∫–µ –ø–∞–º—è—Ç–∏ –ø—Ä–∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

### 2.8 –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö —Å–ø–∏—Å–∫–æ–≤

**–§–∞–π–ª:** `/frontend/src/components/Library/BookGrid.tsx`

–ü—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –∫–Ω–∏–≥ –≤—Å–µ –∫–∞—Ä—Ç–æ—á–∫–∏ —Ä–µ–Ω–¥–µ—Ä—è—Ç—Å—è —Å—Ä–∞–∑—É. –î–ª—è –±–∏–±–ª–∏–æ—Ç–µ–∫ —Å 100+ –∫–Ω–∏–≥ —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ.

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å react-window –∏–ª–∏ @tanstack/virtual –¥–ª—è –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏.

---

## 3. –ù–∞—Ä—É—à–µ–Ω–∏—è React Best Practices

### 3.1 Inline styles –≤–º–µ—Å—Ç–æ CSS –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

**–§–∞–π–ª:** `/frontend/src/components/Library/BookCard.tsx`

```tsx
<div
  style={{
    backgroundColor: 'var(--bg-secondary)',
    borderColor: 'var(--border-color)',
  }}
>
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –°–º–µ—à–µ–Ω–∏–µ inline styles –∏ CSS –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö. –õ—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Tailwind —Å CSS –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –∏–ª–∏ —á–∏—Å—Ç—ã–µ className.

### 3.2 eslint-disable –±–µ–∑ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è –ø—Ä–∏—á–∏–Ω—ã

**–§–∞–π–ª:** `/frontend/src/hooks/useReadingSession.ts` (—Å—Ç—Ä–æ–∫–∞ 1)

```tsx
/* eslint-disable react-hooks/exhaustive-deps */
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –ì–ª–æ–±–∞–ª—å–Ω–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞ –Ω–∞ –≤–µ—Å—å —Ñ–∞–π–ª —Å–∫—Ä—ã–≤–∞–µ—Ç –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –±–∞–≥–∏.

**–§–∞–π–ª:** `/frontend/src/components/Reader/EpubReader.tsx` (—Å—Ç—Ä–æ–∫–∞ 295)

```tsx
}, [currentCFI]); // Only depend on currentCFI, not selection/clearSelection to avoid loops // eslint-disable-line react-hooks/exhaustive-deps
```

### 3.3 –ü—Ä—è–º–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ localStorage –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö

**–§–∞–π–ª:** `/frontend/src/components/Reader/EpubReader.tsx` (—Å—Ç—Ä–æ–∫–∞ 90)

```tsx
const authToken = localStorage.getItem(STORAGE_KEYS.AUTH_TOKEN);
```

**–†–µ—à–µ–Ω–∏–µ:** –í—ã–Ω–µ—Å—Ç–∏ –≤ –∫–∞—Å—Ç–æ–º–Ω—ã–π —Ö—É–∫ `useAuth()` –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç.

### 3.4 –°–º–µ—à–µ–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ –∏ UI –≤ –æ–¥–Ω–æ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ

**–§–∞–π–ª:** `/frontend/src/components/Reader/EpubReader.tsx`

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç 640 —Å—Ç—Ä–æ–∫ —Å 18+ —Ö—É–∫–∞–º–∏ –∏ —Å–ª–æ–∂–Ω–æ–π –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–æ–π. –≠—Ç–æ –Ω–∞—Ä—É—à–∞–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø Single Responsibility.

**–†–µ—à–µ–Ω–∏–µ:** –†–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞:
- `EpubReaderContainer` (–ª–æ–≥–∏–∫–∞)
- `EpubReaderView` (UI)

### 3.5 –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Error Boundaries –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã Reader, ImageModal, BookCard –Ω–µ –æ–±–µ—Ä–Ω—É—Ç—ã –≤ Error Boundaries.

### 3.6 –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ index –∫–∞–∫ key –≤ —Å–ø–∏—Å–∫–∞—Ö

–ù–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ —è–≤–Ω—ã—Ö –Ω–∞—Ä—É—à–µ–Ω–∏–π, –Ω–æ —Å–ª–µ–¥—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ .map() –≤—ã–∑–æ–≤—ã.

---

## 4. –ü—Ä–æ–±–ª–µ–º—ã —Å TypeScript —Ç–∏–ø–∞–º–∏

### 4.1 –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `any` —Ç–∏–ø–∞

**–§–∞–π–ª:** `/frontend/src/hooks/epub/useChapterManagement.ts` (—Å—Ç—Ä–æ–∫–∏ 221-229)

```tsx
} catch (extractError: any) {
  if (extractError?.response?.status === 409 || extractError?.status === 409) {
```

**–†–µ—à–µ–Ω–∏–µ:**
```tsx
} catch (extractError: unknown) {
  if (extractError instanceof AxiosError && extractError.response?.status === 409) {
```

### 4.2 –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–æ–≤

**–§–∞–π–ª—ã:** `/frontend/src/types/api.ts` –∏ `/frontend/src/stores/reader.ts`

```tsx
// –í api.ts:
export interface ReadingProgress {
  book_id: string;
  current_page: number;
  // ...
}

// –í reader.ts:
export interface ReadingProgress {
  bookId: string;
  currentPage: number;
  // ...
}
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –î–≤–∞ —Ä–∞–∑–Ω—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º –∏–º–µ–Ω–µ–º –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ü–µ–ª–µ–π.

### 4.3 –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ strict null checks –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –º–µ—Å—Ç–∞—Ö

**–§–∞–π–ª:** `/frontend/src/components/Images/ImageModal.tsx` (—Å—Ç—Ä–æ–∫–∞ 34)

```tsx
const [currentImageUrl, setCurrentImageUrl] = useState(imageUrl);
```

–ü—Ä–∏ `imageUrl = undefined` —Å–æ—Å—Ç–æ—è–Ω–∏–µ –±—É–¥–µ—Ç –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º.

### 4.4 –ù–µ—è–≤–Ω—ã–µ —Ç–∏–ø—ã –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ö—É–∫–∞—Ö

**–§–∞–π–ª:** `/frontend/src/hooks/api/useBooks.ts` (—Å—Ç—Ä–æ–∫–∏ 100-118)

–í–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–π —Ç–∏–ø useBooks –Ω–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω, –ø–æ–ª–∞–≥–∞–µ—Ç—Å—è –Ω–∞ inference.

---

## 5. –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞

### 5.1 –ü–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è theme-aware —Ü–≤–µ—Ç–∞

**–§–∞–π–ª—ã:**
- `/frontend/src/components/Reader/ReaderHeader.tsx` (—Å—Ç—Ä–æ–∫–∏ 47-86)
- `/frontend/src/components/Reader/EpubReader.tsx` (—Å—Ç—Ä–æ–∫–∏ 437-448)
- `/frontend/src/components/Reader/TocSidebar.tsx`

–ö–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∏–º–µ–µ—Ç —Å–≤–æ—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é `getThemeColors()`.

**–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞—Ç—å –æ–±—â–∏–π —Ö—É–∫ `useThemeColors(theme)` –∏–ª–∏ —É—Ç–∏–ª–∏—Ç—É.

### 5.2 –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞—Ç

**–§–∞–π–ª:** `/frontend/src/components/Library/BookCard.tsx` (—Å—Ç—Ä–æ–∫–∏ 34-41)

```tsx
const formatDate = (dateString: string): string => {
  const date = new Date(dateString);
  return date.toLocaleDateString('ru-RU', {
    day: 'numeric',
    month: 'long',
    year: 'numeric'
  }).replace(' –≥.', '–≥.');
};
```

–≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –¥—É–±–ª–∏—Ä—É–µ—Ç—Å—è –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö.

**–†–µ—à–µ–Ω–∏–µ:** –í—ã–Ω–µ—Å—Ç–∏ –≤ `/utils/formatters.ts`.

### 5.3 –ü–æ–≤—Ç–æ—Ä—è—é—â–∞—è—Å—è –ª–æ–≥–∏–∫–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –≤ useChapter –∏ useDescriptions

**–§–∞–π–ª—ã:**
- `/frontend/src/hooks/api/useChapter.ts` (—Å—Ç—Ä–æ–∫–∏ 71-125)
- `/frontend/src/hooks/api/useDescriptions.ts` (—Å—Ç—Ä–æ–∫–∏ 71-153)

–û–±–∞ —Ö—É–∫–∞ –∏–º–µ—é—Ç –ø–æ—á—Ç–∏ –∏–¥–µ–Ω—Ç–∏—á–Ω—É—é –ª–æ–≥–∏–∫—É –ø—Ä–æ–≤–µ—Ä–∫–∏ chapterCache.

### 5.4 –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ LLM extraction –ª–æ–≥–∏–∫–∏

**–§–∞–π–ª—ã:**
- `/frontend/src/hooks/api/useDescriptions.ts` (—Å—Ç—Ä–æ–∫–∏ 122-134)
- `/frontend/src/hooks/epub/useChapterManagement.ts` (—Å—Ç—Ä–æ–∫–∏ 193-269)

–õ–æ–≥–∏–∫–∞ retry –ø—Ä–∏ 409 Conflict –¥—É–±–ª–∏—Ä—É–µ—Ç—Å—è.

### 5.5 –ü–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è loading/error states

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã LibraryPage, BookPage, ChapterPage –∏–º–µ—é—Ç –ø–æ—á—Ç–∏ –∏–¥–µ–Ω—Ç–∏—á–Ω—ã–µ loading –∏ error states.

---

## 6. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ö—É–∫–æ–≤

### 6.1 –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª –≤ useReadingSession

**–§–∞–π–ª:** `/frontend/src/hooks/useReadingSession.ts` (—Å—Ç—Ä–æ–∫–∏ 253-272)

```tsx
useEffect(() => {
  if (!enabled || !sessionIdRef.current || isEndingRef.current) {
    return;
  }

  intervalRef.current = setInterval(() => {
    if (sessionIdRef.current && !isEndingRef.current) {
      console.log('‚è±Ô∏è [useReadingSession] Periodic update triggered');
      updatePosition(currentPosition);
    }
  }, updateInterval);

  return () => {
    if (intervalRef.current) {
      clearInterval(intervalRef.current);
      intervalRef.current = null;
    }
  };
}, [enabled, currentPosition, updateInterval, updatePosition]);
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ `currentPosition` (–∫–∞–∂–¥—ã–π —Å–∫—Ä–æ–ª–ª) –∏–Ω—Ç–µ—Ä–≤–∞–ª –ø–µ—Ä–µ—Å–æ–∑–¥–∞–µ—Ç—Å—è.

### 6.2 –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ useEffect –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

**–§–∞–π–ª:** `/frontend/src/components/Images/ImageModal.tsx` (—Å—Ç—Ä–æ–∫–∏ 102-104)

```tsx
React.useEffect(() => {
  setCurrentImageUrl(imageUrl);
}, [imageUrl]);
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –≠—Ç–æ –∞–Ω—Ç–∏–ø–∞—Ç—Ç–µ—Ä–Ω - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è props –≤ state. –õ—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å prop –Ω–∞–ø—Ä—è–º—É—é –∏–ª–∏ derived state.

### 6.3 –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ useEffect –¥–ª—è —Å–≤—è–∑–∞–Ω–Ω–æ–π –ª–æ–≥–∏–∫–∏

**–§–∞–π–ª:** `/frontend/src/components/Reader/EpubReader.tsx`

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç 8+ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö useEffect, –∫–æ—Ç–æ—Ä—ã–µ –ª–æ–≥–∏—á–µ—Å–∫–∏ —Å–≤—è–∑–∞–Ω—ã. –≠—Ç–æ —É—Å–ª–æ–∂–Ω—è–µ—Ç –ø–æ–Ω–∏–º–∞–Ω–∏–µ flow –¥–∞–Ω–Ω—ã—Ö.

---

## 7. –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ Memory Leaks

### 7.1 –ì–ª–æ–±–∞–ª—å–Ω—ã–π searchPatternsCache

**–§–∞–π–ª:** `/frontend/src/hooks/epub/useDescriptionHighlighting.ts` (—Å—Ç—Ä–æ–∫–∞ 86)

```tsx
const searchPatternsCache = new Map<string, SearchPatterns>();
```

–ö—ç—à –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –æ—á–∏—â–∞–µ—Ç—Å—è –ø—Ä–∏ unmount.

### 7.2 Event listeners –≤ useEpubThemes

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å–µ event listeners, –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ `rendition.on()`, —É–¥–∞–ª—è—é—Ç—Å—è –≤ cleanup.

### 7.3 Object URLs –≤ ImageCache

**–§–∞–π–ª:** `/frontend/src/services/imageCache.ts`

Object URLs –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç—Å—è, –Ω–æ cleanup interval (5 –º–∏–Ω—É—Ç) –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ª–∏—à–∫–æ–º —Ä–µ–¥–∫–∏–º –¥–ª—è –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.

### 7.4 –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è —É—Ç–µ—á–∫–∞ –≤ useTextSelection

–ï—Å–ª–∏ selection state –Ω–µ –æ—á–∏—â–∞–µ—Ç—Å—è –ø—Ä–∏ unmount, –º–æ–∂–µ—Ç –æ—Å—Ç–∞—Ç—å—Å—è —Å—Å—ã–ª–∫–∞ –Ω–∞ DOM.

---

## 8. –ü—Ä–æ–±–ª–µ–º—ã —Å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å—é (a11y)

### 8.1 –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ ARIA –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –Ω–∞ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–∞—Ö

**–§–∞–π–ª:** `/frontend/src/components/Reader/EpubReader.tsx` (—Å—Ç—Ä–æ–∫–∏ 481-515)

```tsx
<div
  className="fixed left-0 bottom-0 w-[25%] z-[5] md:hidden"
  onClick={() => handleTapZone('left')}
  aria-label="Previous page"
  role="button"
/>
```

–•–æ—Ç—è aria-label –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç, –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç:
- `tabIndex` –¥–ª—è keyboard navigation
- `aria-keyshortcuts` –¥–ª—è –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è –≥–æ—Ä—è—á–∏—Ö –∫–ª–∞–≤–∏—à

### 8.2 –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ focus management –≤ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–Ω–∞—Ö

**–§–∞–π–ª:** `/frontend/src/components/Images/ImageModal.tsx`

–ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Ñ–æ–∫—É—Å –Ω–µ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—Å—è –≤–Ω—É—Ç—Ä—å, –∏ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏.

### 8.3 –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π –∫–æ–Ω—Ç—Ä–∞—Å—Ç –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ç–µ–º–∞—Ö

Sepia —Ç–µ–º–∞ –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π –∫–æ–Ω—Ç—Ä–∞—Å—Ç –¥–ª—è —Ç–µ–∫—Å—Ç–∞ (–Ω–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ WCAG).

### 8.4 –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ skip-links

–ù–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –Ω–∞–≤–∏–≥–∞—Ü–∏—é –∏ –ø–µ—Ä–µ–π—Ç–∏ —Å—Ä–∞–∑—É –∫ –∫–æ–Ω—Ç–µ–Ω—Ç—É.

### 8.5 –ò–∫–æ–Ω–∫–∏ –±–µ–∑ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤

**–§–∞–π–ª:** `/frontend/src/components/Reader/ReaderHeader.tsx` (—Å—Ç—Ä–æ–∫–∏ 117-141)

```tsx
<button title="–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ">
  <List className="w-5 h-5" />
</button>
```

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ `title`, –Ω–æ –Ω–µ—Ç `aria-label` –¥–ª—è screen readers.

### 8.6 –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ aria-live –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞

–ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –æ–ø–∏—Å–∞–Ω–∏–π, —Å–º–µ–Ω–µ —Å—Ç—Ä–∞–Ω–∏—Ü –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –¥–ª—è screen readers.

### 8.7 –ö–Ω–æ–ø–∫–∏ –±–µ–∑ accessible names

–ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∫–Ω–æ–ø–∫–∏ –≤ BookCard –∏ –¥—Ä—É–≥–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö –Ω–µ –∏–º–µ—é—Ç accessible names.

---

## 9. –ú–µ—Ä—Ç–≤—ã–π –∫–æ–¥

### 9.1 –ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥

**–§–∞–π–ª:** `/frontend/src/hooks/epub/useDescriptionHighlighting.ts` (—Å—Ç—Ä–æ–∫–∏ 164-204)

```tsx
/**
 * @deprecated - Too slow for main thread, use requestIdleCallback in future
 */
/*
const findLongestCommonSubstring = (text1: string, text2: string, minLength: number = 30): string | null => {
  // 40 —Å—Ç—Ä–æ–∫ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–æ–¥–∞
};
*/
```

### 9.2 –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ñ–∞–π–ª—ã —Å—Ç—Ä–∞–Ω–∏—Ü

**–§–∞–π–ª—ã:**
- `/frontend/src/pages/NotFoundPageOld.tsx`
- `/frontend/src/pages/HomePageOld.tsx`
- `/frontend/src/pages/BookPageOld.tsx`
- `/frontend/src/pages/RegisterPageOld.tsx`
- `/frontend/src/pages/LoginPageOld.tsx`

5 —Ñ–∞–π–ª–æ–≤ —Å —Å—É—Ñ—Ñ–∏–∫—Å–æ–º `Old` –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ —Ä–æ—É—Ç–∏–Ω–≥–µ.

### 9.3 –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

**–§–∞–π–ª:** `/frontend/src/components/Reader/EpubReader.tsx` (—Å—Ç—Ä–æ–∫–∏ 162-167)

```tsx
isGenerating: _isGeneratingImage, // Available for future use
// ...
isCached: _isCached, // For future UI indicator
```

–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `_` –æ–±–æ–∑–Ω–∞—á–µ–Ω—ã –∫–∞–∫ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ.

### 9.4 –ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π useEffect

**–§–∞–π–ª:** `/frontend/src/hooks/useReadingSession.ts` (—Å—Ç—Ä–æ–∫–∏ 285-292)

```tsx
// useEffect(() => {
//   if (!enabled || !sessionIdRef.current || isEndingRef.current) {
//     return;
//   }
//
//   updatePosition(currentPosition);
// }, [enabled, currentPosition, updatePosition]);
```

### 9.5 –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è normalizedTextCache

**–§–∞–π–ª:** `/frontend/src/hooks/epub/useDescriptionHighlighting.ts` (—Å—Ç—Ä–æ–∫–∏ 68-70)

```tsx
/**
 * NOTE: Currently not used, reserved for future optimization
 */
// const normalizedTextCache = new WeakMap<object, string>();
```

### 9.6 –ü—É—Å—Ç–∞—è —Ñ—É–Ω–∫—Ü–∏—è useBookDescriptions

**–§–∞–π–ª:** `/frontend/src/hooks/api/useDescriptions.ts` (—Å—Ç—Ä–æ–∫–∏ 330-360)

```tsx
export function useBookDescriptions(
  bookId: string,
  options?: ...
) {
  // ...
  queryFn: async () => {
    // –î–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–µ–Ω –æ—Ç–¥–µ–ª—å–Ω—ã–π API endpoint
    // –ü–æ–∫–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤
    // TODO: –î–æ–±–∞–≤–∏—Ç—å batch endpoint –Ω–∞ backend
    console.warn('...');
    return [];
  },
  enabled: false, // –û—Ç–∫–ª—é—á–µ–Ω–æ –¥–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ backend endpoint
```

---

## 10. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é

### –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

1. **–î–æ–±–∞–≤–∏—Ç—å React.memo** –¥–ª—è BookCard, LibraryStats, –∏ –¥—Ä—É–≥–∏—Ö —á–∞—Å—Ç–æ —Ä–µ–Ω–¥–µ—Ä—è—â–∏—Ö—Å—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
2. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å useReadingSession** - —É–±—Ä–∞—Ç—å currentPosition –∏–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π useEffect —Å interval
3. **–û—á–∏—Å—Ç–∫–∞ searchPatternsCache** - –¥–æ–±–∞–≤–∏—Ç—å cleanup –ø—Ä–∏ unmount EpubReader
4. **–î–æ–±–∞–≤–∏—Ç—å Error Boundaries** –≤–æ–∫—Ä—É–≥ Reader –∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
5. **–£–±—Ä–∞—Ç—å eslint-disable** –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏

### –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

6. **–°–æ–∑–¥–∞—Ç—å –æ–±—â–∏–π —Ö—É–∫ useThemeColors** –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
7. **–í—ã–Ω–µ—Å—Ç–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç** –≤ /utils/formatters.ts
8. **–î–æ–±–∞–≤–∏—Ç—å aria-label** –∫–æ –≤—Å–µ–º icon-only –∫–Ω–æ–ø–∫–∞–º
9. **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å focus trap** –≤ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–Ω–∞—Ö
10. **–£–±—Ä–∞—Ç—å console.log** –∏–ª–∏ –æ–±–µ—Ä–Ω—É—Ç—å –≤ isDev check

### –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

11. **–£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª—ã *Old.tsx** –∏–∑ /pages/
12. **–£–¥–∞–ª–∏—Ç—å –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥** –∏–ª–∏ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é –≤–µ—Ç–∫—É
13. **–î–æ–±–∞–≤–∏—Ç—å –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—é** –¥–ª—è BookGrid –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –∫–Ω–∏–≥
14. **–ó–∞–º–µ–Ω–∏—Ç—å polling –Ω–∞ WebSocket** –¥–ª—è —Å—Ç–∞—Ç—É—Å–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–Ω–∏–≥
15. **–†–∞–∑–¥–µ–ª–∏—Ç—å EpubReader** –Ω–∞ Container/View –ø–∞—Ç—Ç–µ—Ä–Ω

---

## –ú–µ—Ç—Ä–∏–∫–∏ –∫–æ–¥–∞

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è |
|---------|----------|--------------|
| –°–∞–º—ã–π –±–æ–ª—å—à–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç | EpubReader.tsx (640 —Å—Ç—Ä–æ–∫) | < 300 —Å—Ç—Ä–æ–∫ |
| –°–∞–º—ã–π –±–æ–ª—å—à–æ–π —Ö—É–∫ | useDescriptionHighlighting.ts (731 —Å—Ç—Ä–æ–∫–∞) | < 200 —Å—Ç—Ä–æ–∫ |
| –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ö—É–∫–æ–≤ –≤ EpubReader | 18 | < 10 |
| –§–∞–π–ª—ã —Å eslint-disable | 2 | 0 |
| –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã | 5 | 0 |
| console.log –≤—ã–∑–æ–≤–æ–≤ | 150+ | 0 –≤ production |

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç –∏–º–µ–µ—Ç —Ö–æ—Ä–æ—à—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –ø–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ December 2025, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ —É–ª—É—á—à–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏. –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å–≤—è–∑–∞–Ω—ã —Å:

1. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ–º –º–µ–º–æ–∏–∑–∞—Ü–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –∏ —Ñ—É–Ω–∫—Ü–∏–π
2. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤ useEffect
3. –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∫–æ–¥–∞ –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏
4. –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å—é –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –Ω–∞—á–∞—Ç—å —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º –≤—ã—Å–æ–∫–æ–≥–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –≤–ª–∏—è—Ç—å –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

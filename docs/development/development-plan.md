# План разработки BookReader AI

## Текущий спринт: Phase 1 - MVP Development (Неделя 1-2/20)

### Завершенные задачи (Phase 0):
- [x] **Создание структуры проекта** (Завершено: 23.08)
- [x] **Инициализация документации** (Завершено: 23.08)
- [x] **Настройка инфраструктуры** (Завершено: 23.08)

### Завершенные задачи (Phase 1):
- [x] **Database Schema & Models** (Завершено: 23.08)
  - [x] SQLAlchemy модели для Users, Books, Chapters, Descriptions, Images
  - [x] Relationships и cascade операции
  - [x] Модели для подписок и прогресса чтения
  
- [x] **Book Processing System** (Завершено: 23.08)
  - [x] Парсер EPUB и FB2 книг
  - [x] Извлечение метаданных и содержимого
  - [x] Система управления книгами (BookService)
  - [x] API endpoints для загрузки и управления книгами

- [x] **NLP Processing System** (Завершено: 23.08)
  - [x] NLPProcessor с приоритизированной экстракцией
  - [x] Поддержка 5 типов описаний с приоритетами
  - [x] Интеграция с spaCy, NLTK, Natasha
  - [x] API endpoints для тестирования NLP

### Активные задачи:
- [ ] **Authentication System** (Дедлайн: 30.08)
  - [ ] JWT токены (access + refresh)
  - [ ] Регистрация и авторизация API
  - [ ] Middleware для авторизации
  - [ ] Система ролей (user, admin)

---

## Phase 1: MVP Development (8-10 недель)

### Неделя 1-2: Базовая архитектура
- [ ] **Database Schema & Models** (Приоритет: Высокий)
  - [ ] SQLAlchemy модели для Users, Books, Chapters
  - [ ] Alembic миграции  
  - [ ] Базовые CRUD операции
  - [ ] Тестирование моделей

- [ ] **Authentication System** (Приоритет: Высокий)
  - [ ] JWT токены (access + refresh)
  - [ ] Регистрация и авторизация API
  - [ ] Middleware для авторизации
  - [ ] Базовая система ролей

- [ ] **Frontend Base** (Приоритет: Средний)
  - [ ] React + TypeScript + Vite настройка
  - [ ] Tailwind CSS конфигурация
  - [ ] React Router маршрутизация
  - [ ] Zustand для state management
  - [ ] Базовые компоненты (Button, Input, Layout)

### Неделя 3-5: Book Processing
- [ ] **EPUB Parser** (Приоритет: Критический)
  - [ ] ebooklib интеграция
  - [ ] Извлечение метаданных и содержимого
  - [ ] Обработка CSS стилей и изображений
  - [ ] Сохранение структуры глав
  - [ ] Валидация и безопасность

- [ ] **FB2 Parser** (Приоритет: Высокий)
  - [ ] python-fb2 интеграция  
  - [ ] Поддержка разных кодировок
  - [ ] Извлечение структуры и метаданных
  - [ ] Обработка форматирования

- [ ] **Book Reader Interface** (Приоритет: Критический)
  - [ ] Постраничная пагинация
  - [ ] Адаптивный дизайн для мобильных
  - [ ] Настройки шрифтов и тем
  - [ ] Навигация между главами
  - [ ] Закладки и заметки

### Неделя 6-9: NLP Parser (КРИТИЧЕСКИ ВАЖНО!)
- [ ] **spaCy Integration** (Приоритет: Критический)
  - [ ] Загрузка ru_core_news_lg модели
  - [ ] Базовая токенизация и POS-тегирование
  - [ ] Named Entity Recognition (NER)
  - [ ] Настройка pipeline для русского языка

- [ ] **Description Extraction** (Приоритет: Критический)
  - [ ] Rule-based извлечение описаний локаций
  - [ ] Извлечение описаний персонажей
  - [ ] Классификация по типам (локации > персонажи > атмосфера)
  - [ ] Фильтрация по качеству и длине
  - [ ] Контекстное обогащение

- [ ] **Parser Quality Control** (Приоритет: Высокий)
  - [ ] Метрики precision/recall
  - [ ] A/B тестирование настроек
  - [ ] Интерфейс для тестирования парсера
  - [ ] Настройки чувствительности в админке

### Неделя 10: Image Generation
- [ ] **pollinations.ai Integration** (Приоритет: Высокий)
  - [ ] HTTP клиент для API
  - [ ] Промпт-инжиниринг по типам описаний
  - [ ] Стили по жанрам книг
  - [ ] Кэширование и дедупликация изображений

- [ ] **UI Integration** (Приоритет: Средний)
  - [ ] Модальные окна для просмотра изображений
  - [ ] Индикаторы готовности изображений
  - [ ] WebSocket уведомления о статусе генерации
  - [ ] Fallback при ошибках

### Неделя 11-12: Subscription & Admin
- [ ] **Subscription System** (Приоритет: Средний)
  - [ ] Планы FREE/PREMIUM/ULTIMATE
  - [ ] ЮKassa интеграция
  - [ ] Rate limiting по планам
  - [ ] Система промокодов

- [ ] **Basic Admin Panel** (Приоритет: Низкий)  
  - [ ] Dashboard с KPI
  - [ ] Управление пользователями
  - [ ] Настройки парсера
  - [ ] Мониторинг очередей

---

## Phase 2: Improvements (6-8 недель)

### Продвинутый NLP Parser
- [ ] Контекстное связывание персонажей
- [ ] Эволюция персонажей во времени
- [ ] Альтернативные NLP библиотеки (NLTK, Natasha)
- [ ] Машинное обучение для улучшения точности

### Дополнительные AI сервисы
- [ ] OpenAI DALL-E 3 интеграция
- [ ] Stable Diffusion через Replicate
- [ ] Улучшенный промпт-инжиниринг
- [ ] Пользовательские стили генерации

### UX/Performance оптимизации
- [ ] PWA функциональность
- [ ] Service Worker для офлайн-режима
- [ ] Lazy loading изображений
- [ ] Database индексы и оптимизация запросов

---

## Phase 3: Scaling (4-6 недель)

### Инфраструктура
- [ ] CDN для изображений
- [ ] Микросервисная архитектура
- [ ] Горизонтальное масштабирование Celery
- [ ] Мониторинг и алерты

### Advanced Features
- [ ] API для разработчиков
- [ ] Социальные функции (шеринг, рекомендации)
- [ ] Расширенная аналитика
- [ ] ML-рекомендации книг

---

## Риски и митигация

### Высокие риски:
1. **Качество NLP парсера** - основная ценность проекта
   - Митигация: Много времени на тестирование, A/B тесты, метрики качества

2. **Производительность генерации изображений**
   - Митигация: Кэширование, предзагрузка, fallback стратегии

3. **Сложность интеграции с платежными системами**
   - Митигация: Начать с простейшего MVP, пошаговая интеграция

### Средние риски:
1. **Масштабирование при росте пользователей**
2. **Безопасность загружаемых файлов**
3. **Авторские права на контент**

---

## Изменения в плане:

**23.08.2024:** Создан первоначальный план разработки на основе детального промпта
**23.08.2024:** Добавлен Phase 0 для инициализации проекта